{"version":3,"file":"merge.js","sourceRoot":"","sources":["../../src/common/merge.ts"],"names":[],"mappings":"AACA,OAAO,SAAS,MAAM,WAAW,CAAC;AAElC,2DAA2D;AAC3D,SAAS,uBAAuB,CAAC,KAAY;IAC3C,KAAK,MAAM,IAAI,IAAI,KAAK,CAAC,KAAK,IAAI,EAAE,EAAE;QACpC,sEAAsE;QACtE,OAAQ,IAAY,CAAC,YAAY,CAAC;QAClC,OAAO,IAAI,CAAC,WAAW,CAAC;KACzB;AACH,CAAC;AAED,kCAAkC;AAClC,MAAM,UAAU,WAAW,CAAC,QAAe,EAAE,KAAY;IACvD,uBAAuB,CAAC,KAAK,CAAC,CAAC;IAE/B,MAAM,QAAQ,GAAU,SAAS,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;IAEnD,wCAAwC;IACxC,EAAE;IACF,uEAAuE;IACvE,qEAAqE;IACrE,yCAAyC;IACzC,IAAI,KAAK,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,EAAE;QACjC,QAAQ,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,CAAC;KAChD;IAED,oEAAoE;IACpE,uCACK,QAAQ,KACX,GAAG,kCACE,QAAQ,CAAC,GAAG,GACZ,KAAK,CAAC,GAAG,KAEd;AACJ,CAAC","sourcesContent":["import { Event } from '@sentry/types';\nimport deepMerge from 'deepmerge';\n\n/** Removes private properties from event before merging */\nfunction removePrivateProperties(event: Event): void {\n  for (const span of event.spans || []) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    delete (span as any).spanRecorder;\n    delete span.transaction;\n  }\n}\n\n/** Merges Events with defaults */\nexport function mergeEvents(defaults: Event, event: Event): Event {\n  removePrivateProperties(event);\n\n  const newEvent: Event = deepMerge(defaults, event);\n\n  // We need to copy spans across manually\n  //\n  // Spans contain a custom toJSON function for serialization and without\n  // this they are serialised with camelCase properties rather than the\n  // snake_case required by the Sentry API.\n  if (event.spans || defaults.spans) {\n    newEvent.spans = event.spans || defaults.spans;\n  }\n\n  // We don't want packages array in sdk to get merged with duplicates\n  return {\n    ...newEvent,\n    sdk: {\n      ...defaults.sdk,\n      ...event.sdk,\n    },\n  };\n}\n"]}