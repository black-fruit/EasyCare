{"version":3,"file":"scope-to-main.js","sourceRoot":"","sources":["../../../src/renderer/integrations/scope-to-main.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,cAAc,CAAC;AAE7C,OAAO,EAAE,SAAS,EAAE,MAAM,eAAe,CAAC;AAE1C,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAEhC;;GAEG;AACH,MAAM,OAAO,WAAW;IAAxB;QAIE,kBAAkB;QACX,SAAI,GAAW,WAAW,CAAC,EAAE,CAAC;IAsBvC,CAAC;IApBC,kBAAkB;IACX,SAAS;QACd,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC7B,CAAC;IAED;;OAEG;IACK,mBAAmB;QACzB,MAAM,KAAK,GAAG,aAAa,EAAE,CAAC,QAAQ,EAAE,CAAC;QACzC,IAAI,KAAK,EAAE;YACT,MAAM,GAAG,GAAG,MAAM,EAAE,CAAC;YAErB,KAAK,CAAC,gBAAgB,CAAC,CAAC,YAAY,EAAE,EAAE;gBACtC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,YAAY,EAAE,EAAE,EAAE,IAAK,CAAC,CAAC,CAAC,CAAC;gBAClE,KAAK,CAAC,gBAAgB,EAAE,CAAC;gBACzB,KAAK,CAAC,gBAAgB,EAAE,CAAC;YAC3B,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;;AAzBD,kBAAkB;AACJ,cAAE,GAAW,aAAa,CAAC","sourcesContent":["import { getCurrentHub } from '@sentry/core';\nimport { Integration } from '@sentry/types';\nimport { normalize } from '@sentry/utils';\n\nimport { getIPC } from '../ipc';\n\n/**\n * Passes scope changes to the main process.\n */\nexport class ScopeToMain implements Integration {\n  /** @inheritDoc */\n  public static id: string = 'ScopeToMain';\n\n  /** @inheritDoc */\n  public name: string = ScopeToMain.id;\n\n  /** @inheritDoc */\n  public setupOnce(): void {\n    this._setupScopeListener();\n  }\n\n  /**\n   * Sends the scope to the main process when it updates.\n   */\n  private _setupScopeListener(): void {\n    const scope = getCurrentHub().getScope();\n    if (scope) {\n      const ipc = getIPC();\n\n      scope.addScopeListener((updatedScope) => {\n        ipc.sendScope(JSON.stringify(normalize(updatedScope, 20, 2_000)));\n        scope.clearBreadcrumbs();\n        scope.clearAttachments();\n      });\n    }\n  }\n}\n"]}