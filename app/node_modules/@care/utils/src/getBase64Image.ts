/**
 * @description 获取base64位格式的png图片
 * @param image 已经加载好的图片
 * @return {string} dataURL 图片png形式的base64位字符串
 */
function getBase64Image(image: HTMLImageElement): string {
  if(typeof window === 'undefined') {
    throw new Error('window is undefined');
  }
  let dataURL = '';
  try {
    let canvas: HTMLCanvasElement | null = document.createElement('canvas');
    canvas.width = image.width;
    canvas.height = image.height;

    const ctx: CanvasRenderingContext2D | null = canvas.getContext('2d');
    if (ctx) {
      ctx.drawImage(image, 0, 0, image.width, image.height);
      dataURL = canvas.toDataURL('image/png');
      canvas = null;
    }
  } catch (e) {
    console.error(e);
  }

  return dataURL;
};

export default getBase64Image;