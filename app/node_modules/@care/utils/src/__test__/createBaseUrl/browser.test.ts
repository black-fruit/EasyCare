import createBaseUrl from '../../createBaseUrl';

describe('测试 createBaseUrl 函数', () => {
  delete global.window.location;
  global.window = Object.create(window);

  Object.defineProperty(window, 'location', {
    value: {
      protocol: 'http:',
      hostname: 'abc.com',
      port: '8080',
      search: '?a=b&c=d',
      hash: '#test'
    },
    writable: true
  });
  it('1. 有appendUrl， 有search，有hash', () => {
    expect(createBaseUrl('/hello')).toEqual('http://abc.com:8080/hello?a=b&c=d#test');  
  })

  it('2. 有appendUrl, 有useSearch， 没有useHash', () => {
    expect(createBaseUrl('/hello', true, false)).toEqual('http://abc.com:8080/hello?a=b&c=d');  
  })

  it('3. 有appendUrl, 没有useSearch， 没有useHash', () => {
    expect(createBaseUrl('/hello', false, false)).toEqual('http://abc.com:8080/hello');  
  })

  it('4. 没有port', () => {
    window.location.port = '';
    expect(createBaseUrl('/hello', false, false)).toEqual('http://abc.com/hello');  
  })

  it('5. 明确location', () => {
    window.location.port = '';
    expect(createBaseUrl('/hello', false, false, window.location)).toEqual('http://abc.com/hello');  
  })
})

