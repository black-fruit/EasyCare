import copyTextToClipBoard from '../../copyTextToClipBoard';

describe('window 环境，测试 copyTextToClipBoard 函数', () => {
  
  let originAppendChild = document.body.appendChild;

  beforeAll(() => {
    if (typeof document.execCommand !== 'function') {
      document.execCommand = (commandId: string) => {
        console.log(commandId);
        return true;
      }
    }
    document.body.appendChild = (dom: any) => {
      document.body.myInput = dom;
    }
  });

  afterAll(() => {
    document.body.appendChild = originAppendChild;
  });

  it('1.测试复制: abcd ', () => {
    const spyExecCommand = spyOn(document, 'execCommand');
    expect(spyExecCommand).not.toBeCalled();
    expect(document.body.myInput).toBeUndefined();
    const copyTextStr = 'abcd';
    copyTextToClipBoard(copyTextStr);
    expect(document.body.myInput).not.toBeUndefined();
    expect(document.body.myInput.value).toBe(copyTextStr);
    expect(spyExecCommand).toBeCalled();
  });

})