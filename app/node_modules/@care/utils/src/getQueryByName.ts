type TDecodeFn = (value: string) => string;

/**
 * @description 获取url中query中指定参数名的参数值
 * @param name 参数名
 * @param search url中query部分
 */
function getQueryByName(name: string, search?: string, decodeFn?: TDecodeFn) {
  const reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');
  if(typeof window === 'undefined') {
    throw new Error('window is undefined');
  }

  let query;
  if (search) {
    query = search.substr(1).match(reg);
  } else {
    query = window.location.search.substr(1).match(reg);
  }
  if (query !== null) {
    if (typeof decodeFn === 'function') {
      return decodeFn(query[2]);
    } else {
      return decodeURIComponent(query[2]);
    }
  }
  
  return null;
};

export default getQueryByName;