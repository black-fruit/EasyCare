# @care/utils
源代码目录如下。
```
src
  __test__ 每个公共函数的测试文件目录，测试文件名为*.test.ts
  typings 定义全局的声明
  xxx.ts 单个的公共函数或对象
  index.ts 收集所有的xxx.ts中的导出，并统一导出
```
  

## Introduction
care多项目的公共util，包括公共函数或工具对象。packge.json的scripts对象中添加了三个常用的命令。
```
yarn start: 转换src下的ts代码输出到dist目录。
yarn test: 对代码运行jest测试。
yarn build: `yarn test && yarn start`
```
在提交你的代码前，需要运行yarn build命令。

## Install
```
yarn add @care/utils
```

## Usage
```
// 前端
import { compareStrings } from '@care/utils';
import compareStrings from '@care/utils/dist/compareStrings'

// node端
const { compareStrings } = require('@care/utils');
```

## 如何添加你的代码
**每次新增公共函数或对象时，也需要对其添加测试文件。并且测试覆盖率达到100%才可以提交到远程仓库，如果测试覆盖率达不到100%，会提交失败。** 

**新增后，需要修改index.ts文件，将新增内容从index.ts导出。同时将公共函数或对象的声明（直接拷贝tsc生成的声明文件）添加到README.md的API，以方便查阅。**

如果想要新增的内容发布的npm，那么需要修改package中的version字段，你可以对每次修改后将version的版本号的最后一位+1。如1.0.0 -> 1.0.1。

同时，将你的名字添加到package.json的contributors中。



## API
```javascript
// 比较字符串的每一位数字，比如比较版本
declare function compareStrings(str1: string, str2: string, split?: string): 1 | 0 | -1;

// 格式化时期
declare function dateFormat(fmt: string, time: number | string | Date): string;

// 获取url上的查询擦书
declare function getQueryByName(name: string, search?: string, decodeFn?: Function): any;

// 简单的发布订阅对象
declare type EventListenerProps = {
    bind(name: string, callback: Function): void;
    uniqueBind(name: string, callback: Function): void;
    trigger(name: string, ...args: any[]): void;
    unbind(name?: string): void;
    getStringifyEventObj(): string;
};
declare const EventListener: EventListenerProps;

// 使 promsie 可被 cancel
declare const makePromiseCancelable: <T>(promise: Promise<T>) => {
    promise: Promise<T>;
    cancel(): void;
};

// 根据当前的location信息创建一个新的url
declare function createBaseUrl(appendUrl: string, useSearch?: boolean, useHash?: boolean, localLocation?: Location): string;

// 获取base64位格式的png图片
declare function getBase64Image(image: HTMLImageElement): string;

// 获取加载好的图片
declare function getImage(imageUrl: string, isCrossDomain?: boolean): Promise<HTMLImageElement>;

// px的样式转换为rem的样式
declare function handleStylePx2rem<T extends object>(originStyle: T): T;

// 创建一个指定时间超时的promise，可自定义 reject 的内容
declare function timeoutPromise(timeout?: number, message?: string): Promise<unknown>;
```